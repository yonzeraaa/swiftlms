(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5105],{5040:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},12292:(e,t,s)=>{Promise.resolve().then(s.bind(s,30966))},12318:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},14186:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},17580:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},30966:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>k,dynamic:()=>N});var a=s(95155),l=s(12115),r=s(17580),o=s(5040),d=s(87949),n=s(33109),i=s(53311),c=s(12318),u=s(65980),h=s(79397),m=s(69037),x=s(14186),g=s(57434),p=s(39999),v=s(79720),b=s(767),y=s(46414),j=s(30461),f=s(38758);let N="force-dynamic";function k(){let[e,t]=(0,l.useState)(!0),{t:s}=(0,j.B)(),[N,k]=(0,l.useState)({totalStudents:0,totalInstructors:0,totalCourses:0,publishedCourses:0,totalEnrollments:0,completedEnrollments:0,completionRate:0,activeUsers:0}),[w,A]=(0,l.useState)([]),[_,M]=(0,l.useState)([]),E=(0,y.U)();(0,l.useEffect)(()=>{C()},[]);let C=async()=>{try{let{data:e}=await E.from("profiles").select("role, status, created_at"),t=(null==e?void 0:e.filter(e=>"student"===e.role))||[],a=(null==e?void 0:e.filter(e=>"instructor"===e.role))||[],l=(null==e?void 0:e.filter(e=>"active"===e.status))||[],{data:r}=await E.from("courses").select("*"),o=(null==r?void 0:r.length)||0,d=(null==r?void 0:r.filter(e=>!0===e.is_published).length)||0,{data:n}=await E.from("enrollments").select("*").in("status",["active","completed"]),i=(null==n?void 0:n.length)||0,c=(null==n?void 0:n.filter(e=>"completed"===e.status).length)||0,u=i>0?Math.round(c/i*100):0,h=new Map;null==n||n.forEach(e=>{let t=h.get(e.course_id)||0;h.set(e.course_id,t+1)});let m=[],x=0;null==r||r.forEach(e=>{let t=h.get(e.id)||0;t>0&&(x=Math.max(x,t),m.push({id:e.id,name:e.title,students:t,percentage:0}))}),m.forEach(e=>{e.percentage=x>0?Math.round(e.students/x*100):0}),m.sort((e,t)=>t.students-e.students),M(m.slice(0,4));let{data:g,error:p}=await E.from("activity_logs").select("*").order("created_at",{ascending:!1}).limit(10);p&&console.error("Error fetching activities:",p);let v=[];if(g&&g.length>0){let e=[...new Set(g.map(e=>e.user_id).filter(e=>null!==e))],{data:t}=await E.from("profiles").select("id, full_name, email").in("id",e),a=new Map((null==t?void 0:t.map(e=>[e.id,e]))||[]);for(let e of g){let t=new Date(e.created_at),l=new Date,r=Math.floor((l.getTime()-t.getTime())/6e4),o="";o=r<60?"".concat(r," ").concat(s("dashboard.minutesAgo")):r<1440?"".concat(Math.floor(r/60)," ").concat(s("dashboard.hoursAgo")):"".concat(Math.floor(r/1440)," ").concat(s("dashboard.daysAgo"));let d=e.user_id?a.get(e.user_id):void 0;if(!d&&e.user_id){console.warn("User not found for activity:",e.user_id),v.push({userId:e.user_id,userName:"Unknown User",action:e.action,entityName:e.entity_name||void 0,timestamp:o,icon:"enrollment"});continue}let n="",i="enrollment";switch(e.action){case"user_created":n=s("dashboard.userJoined"),i="user";break;case"course_created":n=s("dashboard.createdCourse"),i="course";break;case"course_published":n=s("dashboard.publishedCourse"),i="course";break;case"enrolled_in_course":n=s("dashboard.enrolledInCourse"),i="enrollment";break;case"student_enrolled":n=s("dashboard.newStudentEnrolled"),i="enrollment";break;case"completed_course":n=s("dashboard.completedCourse"),i="award";break;default:n=e.action}v.push({userId:(null==d?void 0:d.id)||e.user_id||"",userName:d?d.full_name||d.email:"Unknown User",action:n,entityName:e.entity_name||void 0,timestamp:o,icon:i})}}console.log("Total activities found:",(null==g?void 0:g.length)||0),console.log("Activities processed:",v.length),A(v.slice(0,5)),k({totalStudents:t.length,totalInstructors:a.length,totalCourses:o,publishedCourses:d,totalEnrollments:i,completedEnrollments:c,completionRate:u,activeUsers:l.length})}catch(e){console.error("Error fetching dashboard data:",e)}finally{t(!1)}},H=[{title:s("dashboard.totalStudents"),value:N.totalStudents.toString(),icon:(0,a.jsx)(r.A,{className:"w-6 h-6"}),subtitle:"".concat(N.activeUsers," ").concat(s("dashboard.active"))},{title:s("dashboard.activeCourses"),value:N.publishedCourses.toString(),icon:(0,a.jsx)(o.A,{className:"w-6 h-6"}),subtitle:"".concat(N.totalCourses," ").concat(s("dashboard.total"))},{title:s("dashboard.completionRate"),value:"".concat(N.completionRate,"%"),icon:(0,a.jsx)(d.A,{className:"w-6 h-6"}),subtitle:"".concat(N.completedEnrollments," ").concat(s("dashboard.completed"))},{title:s("dashboard.enrollments"),value:N.totalEnrollments.toString(),icon:(0,a.jsx)(n.A,{className:"w-6 h-6"}),subtitle:s("dashboard.totalEnrollments")}];return e?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex justify-between items-center",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"h-8 w-48 bg-navy-700/50 rounded-lg animate-pulse mb-2"}),(0,a.jsx)("div",{className:"h-4 w-64 bg-navy-700/30 rounded animate-pulse"})]})}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)(f.EW,{},t))}),(0,a.jsxs)("div",{className:"bg-navy-800/50 rounded-xl p-6 animate-pulse",children:[(0,a.jsx)("div",{className:"h-6 w-32 bg-navy-700/50 rounded mb-4"}),(0,a.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"h-12 bg-navy-700/30 rounded-lg"},t))})]})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(v.Ay,{variant:"gradient",className:"mb-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold text-gold flex items-center gap-2",children:[(0,a.jsx)(i.A,{className:"w-8 h-8 text-gold-400 animate-pulse"}),s("dashboard.title")]}),(0,a.jsx)("p",{className:"text-gold-300 mt-1",children:s("dashboard.subtitle")})]}),(0,a.jsx)("div",{className:"text-gold-400/60 text-sm",children:new Date().toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsx)(p.A,{...H[0],variant:"gradient",color:"blue"}),(0,a.jsx)(p.A,{...H[1],variant:"gradient",color:"green"}),(0,a.jsx)(p.A,{...H[2],variant:"gradient",color:"purple"}),(0,a.jsx)(p.A,{...H[3],variant:"gradient",color:"gold"})]}),(0,a.jsx)(v.Ay,{title:s("dashboard.recentActivities"),variant:"elevated",action:w.length>0&&(0,a.jsx)(b.A,{variant:"secondary",size:"sm",onClick:()=>window.open("/dashboard/activities","_blank"),children:s("dashboard.viewAll")}),children:(0,a.jsx)("div",{className:"space-y-4",children:w.length>0?w.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start gap-3 pb-4 border-b border-gold-500/20 last:border-0",children:[(0,a.jsxs)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-gold-500/30 to-gold-600/20 flex items-center justify-center text-gold shadow-lg transition-transform hover:scale-110",children:["user"===e.icon&&(0,a.jsx)(c.A,{className:"w-5 h-5"}),"course"===e.icon&&(0,a.jsx)(u.A,{className:"w-5 h-5"}),"enrollment"===e.icon&&(0,a.jsx)(h.A,{className:"w-5 h-5"}),"award"===e.icon&&(0,a.jsx)(m.A,{className:"w-5 h-5"})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("p",{className:"text-gold-200",children:[(0,a.jsx)("span",{className:"font-semibold text-gold",children:e.userName})," ",e.action]}),e.entityName&&(0,a.jsx)("p",{className:"text-gold-400 text-sm",children:e.entityName}),(0,a.jsxs)("p",{className:"text-gold-500/60 text-xs mt-1 flex items-center gap-1",children:[(0,a.jsx)(x.A,{className:"w-3 h-3"}),e.timestamp]})]})]},t)):(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-gold-300",children:s("dashboard.noRecentActivity")})})})}),(0,a.jsx)(v.Ay,{title:s("dashboard.popularCourses"),subtitle:s("dashboard.basedOnEnrollments"),children:(0,a.jsx)("div",{className:"space-y-4",children:_.length>0?_.map((e,t)=>(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gold-200 font-medium",children:e.name}),(0,a.jsxs)("span",{className:"text-gold-400 text-sm",children:[e.students," ",s("dashboard.students")]})]}),(0,a.jsx)("div",{className:"w-full bg-navy-900/50 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-gradient-to-r from-gold-500 to-gold-600 h-2 rounded-full transition-all duration-500",style:{width:"".concat(e.percentage,"%")}})})]},t)):(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-gold-300",children:s("dashboard.noCoursesYet")})})})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsx)(v.Ay,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gold-300 text-sm",children:s("dashboard.instructors")}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gold mt-1",children:N.totalInstructors})]}),(0,a.jsx)(r.A,{className:"w-8 h-8 text-gold-500/30"})]})}),(0,a.jsx)(v.Ay,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gold-300 text-sm",children:s("dashboard.draftCourses")}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gold mt-1",children:N.totalCourses-N.publishedCourses})]}),(0,a.jsx)(g.A,{className:"w-8 h-8 text-gold-500/30"})]})}),(0,a.jsx)(v.Ay,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gold-300 text-sm",children:s("dashboard.ongoingEnrollments")}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gold mt-1",children:N.totalEnrollments-N.completedEnrollments})]}),(0,a.jsx)(h.A,{className:"w-8 h-8 text-gold-500/30"})]})})]})]})}},33109:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},39999:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var a=s(95155);function l(e){let{title:t,value:s,icon:l,trend:r,subtitle:o,variant:d="default",color:n="gold"}=e,i={gold:{gradient:"from-gold-500/20 to-gold-600/10",icon:"bg-gold-500/10 text-gold-400",iconHover:"group-hover:bg-gold-500/20",text:"text-gold",subtitle:"text-gold-300"},blue:{gradient:"from-blue-500/20 to-blue-600/10",icon:"bg-blue-500/10 text-blue-400",iconHover:"group-hover:bg-blue-500/20",text:"text-blue-400",subtitle:"text-blue-300"},green:{gradient:"from-green-500/20 to-green-600/10",icon:"bg-green-500/10 text-green-400",iconHover:"group-hover:bg-green-500/20",text:"text-green-400",subtitle:"text-green-300"},purple:{gradient:"from-purple-500/20 to-purple-600/10",icon:"bg-purple-500/10 text-purple-400",iconHover:"group-hover:bg-purple-500/20",text:"text-purple-400",subtitle:"text-purple-300"},red:{gradient:"from-red-500/20 to-red-600/10",icon:"bg-red-500/10 text-red-400",iconHover:"group-hover:bg-red-500/20",text:"text-red-400",subtitle:"text-red-300"}}[n],c={default:"bg-navy-800/90 border border-gold-500/20 hover:border-gold-500/30",gradient:"bg-gradient-to-br ".concat(i.gradient," backdrop-blur-xl border border-gold-500/10"),minimal:"bg-transparent border-0"};return(0,a.jsxs)("div",{className:"group relative",children:[(0,a.jsx)("div",{className:"absolute -inset-0.5 bg-gradient-to-r from-gold-500/20 to-gold-600/20 rounded-2xl blur opacity-0 group-hover:opacity-100 transition duration-500"}),(0,a.jsxs)("div",{className:"\n        relative rounded-2xl p-6\n        transform transition-all duration-300\n        hover:scale-[1.02] hover:-translate-y-1\n        ".concat(c[d],"\n        shadow-lg hover:shadow-2xl\n      "),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium ".concat(i.subtitle," opacity-90"),children:t}),(0,a.jsx)("p",{className:"text-3xl font-bold mt-2 ".concat(i.text," tracking-tight"),children:(0,a.jsx)("span",{className:"inline-block transition-transform duration-300 group-hover:scale-110",children:s})}),o&&(0,a.jsx)("p",{className:"text-gold-400/60 text-xs mt-2",children:o})]}),(0,a.jsx)("div",{className:"\n            p-3 rounded-xl transition-all duration-300\n            ".concat(i.icon," ").concat(i.iconHover,"\n            transform group-hover:rotate-12 group-hover:scale-110\n          "),children:l})]}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-gold-500/50 to-transparent rounded-b-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-500",children:(0,a.jsx)("div",{className:"h-full bg-gradient-to-r from-gold-500 to-gold-600 animate-shimmer"})})]})]})}},53311:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]])},57434:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},65980:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("book-plus",[["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"M9 10h6",key:"9gxzsh"}]])},69037:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]])},79397:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},87949:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]])}},e=>{e.O(0,[3254,9051,1338,9760,1624,8441,5964,7358],()=>e(e.s=12292)),_N_E=e.O()}]);