(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1525],{13052:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},14186:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},16785:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},33109:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},51270:(e,t,s)=>{Promise.resolve().then(s.bind(s,92868))},57340:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]])},69074:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},72713:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},92868:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var a=s(95155),l=s(12115),i=s(35695),c=s(72713),n=s(43453),o=s(14186),d=s(16785),r=s(69074),m=s(35169),h=s(33109),x=s(767),p=s(46414),u=s(13943),g=s(35494),v=s(38274);function y(e){let{data:t,startDate:s=new Date(new Date().getFullYear(),0,1),endDate:i=new Date,colorScale:c=["#1e3a5f","#2d4a7f","#3b5a9f","#FFD700","#FFA500"],showMonthLabels:n=!0,showLegend:o=!0,tooltipEnabled:d=!0,className:r="",cellSize:m=12,cellGap:h=3}=e,[x,p]=(0,l.useState)(null),[u,g]=(0,l.useState)({x:0,y:0}),y=new Map(t.map(e=>[e.date,e])),f=[],j=new Date(s);for(;j<=i;)f.push(new Date(j)),j.setDate(j.getDate()+1);let N=[],b=[],w=new Date(f[0]).getDay();for(let e=0;e<w;e++)b.push(null);if(f.forEach(e=>{b.push(e),7===b.length&&(N.push(b),b=[])}),b.length>0){for(;b.length<7;)b.push(null);N.push(b)}let A=Math.max(...t.map(e=>e.value),1),_=[],k=-1;return N.forEach((e,t)=>{e.forEach(e=>{e&&e.getMonth()!==k&&(k=e.getMonth(),_.push({month:e.toLocaleDateString("pt-BR",{month:"short"}),col:t}))})}),(0,a.jsxs)("div",{className:"relative ".concat(r),children:[n&&(0,a.jsx)("div",{className:"flex gap-1 mb-2",style:{paddingLeft:"".concat(m+h,"px"),marginLeft:"30px"},children:_.map((e,t)=>(0,a.jsx)("div",{className:"text-xs text-gold-300/70",style:{position:"absolute",left:"".concat(30+e.col*(m+h),"px")},children:e.month},t))}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("div",{className:"flex flex-col justify-between",style:{marginTop:n?"20px":"0"},children:["Dom","Seg","Ter","Qua","Qui","Sex","S\xe1b"].map((e,t)=>(0,a.jsx)("div",{className:"text-xs text-gold-300/50",style:{height:"".concat(m,"px"),marginBottom:"".concat(h,"px"),display:"flex",alignItems:"center"},children:t%2==1?e:""},t))}),(0,a.jsx)("div",{className:"flex gap-1",style:{marginTop:n?"20px":"0"},onMouseMove:e=>{let t=e.currentTarget.getBoundingClientRect();g({x:e.clientX-t.left,y:e.clientY-t.top})},children:N.map((e,t)=>(0,a.jsx)("div",{className:"flex flex-col gap-1",children:e.map((e,s)=>{if(!e)return(0,a.jsx)("div",{style:{width:"".concat(m,"px"),height:"".concat(m,"px"),marginBottom:"".concat(h-1,"px")}},"empty-".concat(t,"-").concat(s));let l=e.toISOString().split("T")[0],i=y.get(l),n=(e=>{if(0===e)return"bg-navy-800/50";let t=Math.floor(e/A*(c.length-1));return c[Math.min(t,c.length-1)]})((null==i?void 0:i.value)||0);return(0,a.jsx)(v.P.div,{className:"rounded-sm cursor-pointer transition-all ".concat("string"==typeof n&&n.startsWith("bg-")?n:""),style:{width:"".concat(m,"px"),height:"".concat(m,"px"),marginBottom:"".concat(h-1,"px"),backgroundColor:"string"!=typeof n||n.startsWith("bg-")?void 0:n},initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:(7*t+s)*.005,duration:.3},whileHover:{scale:1.2},onMouseEnter:()=>{d&&i&&p(i)},onMouseLeave:()=>p(null)},l)})},t))})]}),o&&(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-4",children:[(0,a.jsx)("span",{className:"text-xs text-gold-300/70",children:"Menos"}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-sm bg-navy-800/50"}),c.map((e,t)=>(0,a.jsx)("div",{className:"w-3 h-3 rounded-sm ".concat(e.startsWith("bg-")?e:""),style:{backgroundColor:e.startsWith("bg-")?void 0:e}},t))]}),(0,a.jsx)("span",{className:"text-xs text-gold-300/70",children:"Mais"})]}),d&&x&&(0,a.jsxs)(v.P.div,{className:"absolute z-50 px-3 py-2 bg-navy-700 border border-gold-500/30 rounded-lg shadow-xl pointer-events-none",style:{left:u.x+10,top:u.y-40},initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.1},children:[(0,a.jsx)("div",{className:"text-xs text-gold-200",children:new Date(x.date).toLocaleDateString("pt-BR",{day:"numeric",month:"long",year:"numeric"})}),(0,a.jsxs)("div",{className:"text-sm font-semibold text-gold",children:[x.value," ",x.label||"atividades"]})]})]})}var f=s(60567),j=s(79720);function N(e){let{stats:t,chart:s,activity:l,quickActions:i,className:c=""}=e;return(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 ".concat(c),children:[t.map((e,t)=>(0,a.jsx)(v.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*t,duration:.5},children:(0,a.jsx)(j.Ay,{variant:"glass",hoverable:!0,depth:3,children:e})},t)),(0,a.jsx)(v.P.div,{className:"md:col-span-2 lg:col-span-2 lg:row-span-2",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:(0,a.jsx)(j.Ay,{variant:"premium",className:"h-full",children:s})}),(0,a.jsx)(v.P.div,{className:"lg:col-span-1 lg:row-span-2",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.3,duration:.5},children:(0,a.jsx)(j.Ay,{variant:"gradient",className:"h-full",children:l})}),(0,a.jsx)(v.P.div,{className:"lg:col-span-1",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4,duration:.5},children:(0,a.jsx)(j.Ay,{variant:"holographic",hoverable:!0,children:i})})]})}function b(){let e=(0,i.useParams)(),t=(0,i.useRouter)(),s=e.id,v=(0,p.U)(),[j,b]=(0,l.useState)(null),[w,A]=(0,l.useState)(null),[_,k]=(0,l.useState)(null),[M,D]=(0,l.useState)(!0);(0,l.useEffect)(()=>{s&&S()},[s]);let S=async()=>{try{var e,a,l,i,c;let{data:{user:n}}=await v.auth.getUser();if(!n)return void t.push("/");let[o,d]=await Promise.all([v.from("courses").select("*").eq("id",s).single(),v.from("enrollments").select("*").eq("course_id",s).eq("user_id",n.id).single()]);if(o.error||!o.data)return void t.push("/student-dashboard/my-courses");if(d.error||!d.data)return void t.push("/student-dashboard/courses");b(o.data),A(d.data);let{data:r}=await v.from("course_modules").select("\n          *,\n          lessons(*)\n        ").eq("course_id",s),{data:m}=await v.from("lesson_progress").select("*").eq("enrollment_id",d.data.id),h=0,x=0,p=[];r&&r.forEach(e=>{let t=e.lessons||[];h+=t.length,t.forEach(e=>{let t=null==m?void 0:m.find(t=>t.lesson_id===e.id);(null==t?void 0:t.is_completed)?(x++,t.completed_at&&p.push({date:t.completed_at,lesson:e.title,type:"completed"})):(null==t?void 0:t.started_at)&&p.push({date:t.started_at,lesson:e.title,type:"started"})})}),p.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime());let u=C(m||[]),g=0;m&&m.length>0&&(m.forEach(e=>{if(e.is_completed&&e.completed_at&&e.started_at){let t=new Date(e.started_at).getTime(),s=new Date(e.completed_at).getTime(),a=Math.round((s-t)/6e4);g+=a}}),0===g&&(g=20*x));let y=h>0?x/h:0,f=[{title:"Primeira aula conclu\xedda",completed:x>=1,completedAt:x>=1?null==(e=p.find(e=>"completed"===e.type))?void 0:e.date:void 0},{title:"25% do curso conclu\xeddo",completed:y>=.25,completedAt:y>=.25?null==(a=p[Math.floor(.75*p.length)])?void 0:a.date:void 0},{title:"50% do curso conclu\xeddo",completed:y>=.5,completedAt:y>=.5?null==(l=p[Math.floor(.5*p.length)])?void 0:l.date:void 0},{title:"75% do curso conclu\xeddo",completed:y>=.75,completedAt:y>=.75?null==(i=p[Math.floor(.25*p.length)])?void 0:i.date:void 0},{title:"Curso conclu\xeddo",completed:1===y,completedAt:1===y?null==(c=p[0])?void 0:c.date:void 0}];k({totalLessons:h,completedLessons:x,timeSpent:g,weeklyActivity:u,recentActivity:p.slice(0,10),milestones:f})}catch(e){console.error("Error fetching progress data:",e)}finally{D(!1)}},C=e=>{let t=[],s=new Date,a=new Map;e.forEach(e=>{if(e.started_at){let t=new Date(e.started_at).toISOString().split("T")[0];a.set(t,(a.get(t)||0)+1)}if(e.completed_at&&e.completed_at!==e.started_at){let t=new Date(e.completed_at).toISOString().split("T")[0];a.set(t,(a.get(t)||0)+1)}if(e.last_accessed_at&&e.last_accessed_at!==e.started_at&&e.last_accessed_at!==e.completed_at){let t=new Date(e.last_accessed_at).toISOString().split("T")[0];a.set(t,(a.get(t)||0)+1)}});for(let e=30;e>=0;e--){let l=new Date(s);l.setDate(l.getDate()-e);let i=l.toISOString().split("T")[0];t.push({date:i,value:a.get(i)||0})}return t};if(M)return(0,a.jsx)("div",{className:"flex justify-center items-center min-h-[60vh]",children:(0,a.jsx)(f.A,{size:"xl"})});if(!j||!_)return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[60vh]",children:[(0,a.jsx)(c.A,{className:"w-16 h-16 text-gold-500/30 mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gold-200 mb-2",children:"Progresso n\xe3o encontrado"}),(0,a.jsx)(x.A,{onClick:()=>t.push("/student-dashboard/my-courses"),children:"Voltar aos Meus Cursos"})]});let L=_.totalLessons>0?Math.round(_.completedLessons/_.totalLessons*100):0,T=[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gold-300 text-sm",children:"Progresso Geral"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gold mt-1",children:[L,"%"]})]}),(0,a.jsx)(u.A,{value:_.completedLessons,max:_.totalLessons,size:60,showValue:!1})]},"progress"),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gold-300 text-sm",children:"Aulas Conclu\xeddas"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gold mt-1",children:[_.completedLessons,"/",_.totalLessons]})]}),(0,a.jsx)(n.A,{className:"w-8 h-8 text-green-500/30"})]},"lessons"),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gold-300 text-sm",children:"Tempo Investido"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gold mt-1",children:[Math.floor(_.timeSpent/60),"h ",_.timeSpent%60,"m"]})]}),(0,a.jsx)(o.A,{className:"w-8 h-8 text-blue-500/30"})]},"time"),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gold-300 text-sm",children:"Conquistas"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gold mt-1",children:[_.milestones.filter(e=>e.completed).length,"/",_.milestones.length]})]}),(0,a.jsx)(d.A,{className:"w-8 h-8 text-gold-500/30"})]},"achievements")],E=(0,a.jsxs)("div",{className:"h-full",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gold mb-4",children:"Atividade Semanal"}),(0,a.jsx)(y,{data:_.weeklyActivity,showLegend:!0,cellSize:12,className:"flex justify-center"})]}),P=(0,a.jsxs)("div",{className:"h-full",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gold mb-4",children:"Atividade Recente"}),(0,a.jsxs)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:[_.recentActivity.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-navy-800/30 rounded-lg",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat("completed"===e.type?"bg-green-400":"bg-blue-400")}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gold-200",children:e.lesson}),(0,a.jsxs)("p",{className:"text-xs text-gold-300/70",children:["completed"===e.type?"Conclu\xedda":"Iniciada"," em"," ",new Date(e.date).toLocaleDateString("pt-BR")]})]})]},t)),0===_.recentActivity.length&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(r.A,{className:"w-12 h-12 text-gold-500/30 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-gold-300/70",children:"Nenhuma atividade recente"})]})]})]}),q=(0,a.jsxs)("div",{className:"h-full",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gold mb-4",children:"Conquistas"}),(0,a.jsx)("div",{className:"space-y-3",children:_.milestones.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg ".concat(e.completed?"bg-green-500/20":"bg-navy-800/30"),children:[(0,a.jsx)(n.A,{className:"w-5 h-5 ".concat(e.completed?"text-green-400":"text-gold-300/30")}),(0,a.jsx)("span",{className:"text-sm ".concat(e.completed?"text-green-300":"text-gold-300/70"),children:e.title})]},t))})]});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(g.A,{className:"mb-2"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(x.A,{variant:"ghost",onClick:()=>t.push("/student-dashboard/course/".concat(s)),icon:(0,a.jsx)(m.A,{className:"w-4 h-4"}),children:"Voltar ao Curso"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gold",children:"Progresso do Curso"}),(0,a.jsx)("p",{className:"text-gold-300 mt-1",children:j.title})]})]}),(0,a.jsx)(N,{stats:T,chart:E,activity:P,quickActions:q}),(0,a.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,a.jsx)(x.A,{variant:"primary",onClick:()=>t.push("/student-dashboard/course/".concat(s)),icon:(0,a.jsx)(h.A,{className:"w-4 h-4"}),children:"Continuar Estudando"}),(0,a.jsx)(x.A,{variant:"secondary",onClick:()=>t.push("/student-dashboard/my-courses"),children:"Ver Todos os Cursos"})]})]})}}},e=>{e.O(0,[3254,9051,7244,1338,9760,5406,8441,5964,7358],()=>e(e.s=51270)),_N_E=e.O()}]);