(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1920],{9008:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>P});var s=t(95155),r=t(12115),i=t(6874),l=t.n(i),o=t(35695);function n(e){let a="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===a.length){var t;return(null==(t=a.pop())?void 0:t.split(";").shift())||null}return null}var d=t(65589),c=t(73783),h=t(47924),u=t(5040),m=t(87949),x=t(69074),p=t(81191),f=t(57434),g=t(18186),b=t(381),y=t(42355),v=t(13052),w=t(71007),j=t(35169),N=t(34835),k=t(55870),A=t(46414),M=t(30461),S=t(79884),T=t(38274),E=t(60760);function P(e){let{children:a}=e,[t,i]=(0,r.useState)(!0),[P,C]=(0,r.useState)(null),[V,z]=(0,r.useState)(!1),[H,_]=(0,r.useState)(""),[O,I]=(0,r.useState)(""),[L,U]=(0,r.useState)(!1),[q,J]=(0,r.useState)(!1),D=(0,o.usePathname)();(0,o.useRouter)();let B=(0,A.U)(),{t:R}=(0,M.B)();(0,r.useEffect)(()=>{let e=localStorage.getItem("sidebarOpen");null!==e&&i(JSON.parse(e))},[]),(0,r.useEffect)(()=>{localStorage.setItem("sidebarOpen",JSON.stringify(t))},[t]),(0,r.useEffect)(()=>{F();let e=()=>{let e="true"===n("isAdminViewMode"),a="true"===n("viewAsStudent"),t=n("adminViewId"),s=e||a||!!t;console.log("[STUDENT-LAYOUT] View mode check:",{isAdminViewMode:e,viewAsStudent:a,adminViewId:!!t,final:s}),J(s)};e();let a=setTimeout(e,100);return()=>clearTimeout(a)},[]);let F=async()=>{try{let{data:{user:e}}=await B.auth.getUser();if(e){let{data:a}=await B.from("profiles").select("full_name, email, avatar_url, role").eq("id",e.id).single();a&&(_(a.full_name||a.email),I(a.avatar_url||""),U("admin"===a.role))}}catch(e){console.error("Error fetching student info:",e)}},G=[{name:"Painel Geral",href:"/student-dashboard",icon:c.A},{name:"Explorar Cursos",href:"/student-dashboard/courses",icon:h.A},{name:"Meus Cursos",href:"/student-dashboard/my-courses",icon:u.A},{name:"Progresso",href:"/student-dashboard/progress",icon:m.A},{name:"Calend\xe1rio",href:"/student-dashboard/calendar",icon:x.A},{name:"Testes",href:"/student-dashboard/tests",icon:p.A},{name:"Minhas Notas",href:"/student-dashboard/grades",icon:f.A},{name:"Certificados",href:"/student-dashboard/certificates",icon:g.A},{name:"Configura\xe7\xf5es",href:"/student-dashboard/settings",icon:b.A}],W=async()=>{try{z(!0);{let e=["sb-","supabase","auth-token"],a=[];for(let t=localStorage.length-1;t>=0;t--){let s=localStorage.key(t);s&&e.some(e=>s.includes(e))&&a.push(s)}a.forEach(e=>{console.log("Removing auth key:",e),localStorage.removeItem(e)});for(let a=sessionStorage.length-1;a>=0;a--){let t=sessionStorage.key(a);t&&e.some(e=>t.includes(e))&&sessionStorage.removeItem(t)}}let e=await fetch("/api/auth/logout",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"}),a=await e.json();if(!e.ok)throw console.error("Logout API error:",a),Error(a.error||"Logout failed");await new Promise(e=>setTimeout(e,200)),window.location.href="/"}catch(e){console.error("Error logging out:",e),setTimeout(()=>{window.location.href="/"},1e3),z(!1)}};return(0,s.jsxs)("div",{className:"min-h-screen bg-pattern",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-navy-600/50 via-navy-700/50 to-navy-900/50"}),(0,s.jsxs)("div",{className:"relative flex h-screen",children:[(0,s.jsx)(T.P.aside,{initial:{width:t?256:80},animate:{width:t?256:80},transition:{duration:.3,ease:"easeInOut"},className:"relative bg-navy-900/95 backdrop-blur-md border-r border-gold-500/20 flex-shrink-0",children:(0,s.jsxs)("div",{className:"flex flex-col h-full p-4",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-8",children:(0,s.jsxs)(T.P.div,{className:"flex items-center gap-3",children:[(0,s.jsx)(k.A,{width:48,height:48}),(0,s.jsx)(E.N,{children:t&&(0,s.jsx)(T.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:(0,s.jsx)("p",{className:"text-xs text-gold-300 whitespace-nowrap",children:"Portal do Aluno"})})})]})}),(0,s.jsx)("button",{onClick:()=>i(!t),className:"absolute -right-5 top-12 w-11 h-11 bg-navy-800/95 backdrop-blur-sm border-2 border-gold-500 rounded-full flex items-center justify-center text-gold-400 hover:text-gold-200 hover:bg-navy-700 hover:scale-110 hover:shadow-lg hover:shadow-gold-500/30 transition-all z-50 group","aria-label":t?"Fechar menu lateral":"Abrir menu lateral",children:t?(0,s.jsx)(y.A,{className:"w-5 h-5 group-hover:scale-110 transition-transform"}):(0,s.jsx)(v.A,{className:"w-5 h-5 group-hover:scale-110 transition-transform"})}),(0,s.jsx)(E.N,{children:t&&H&&(0,s.jsx)(T.P.div,{className:"mb-6 p-3 bg-navy-800/50 rounded-lg border border-gold-500/20",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-gold-500/20 flex items-center justify-center overflow-hidden",children:O?(0,s.jsx)("img",{src:O,alt:H,className:"w-full h-full object-cover"}):(0,s.jsx)(w.A,{className:"w-5 h-5 text-gold"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm text-gold-300",children:"Bem-vindo(a),"}),(0,s.jsx)("p",{className:"text-gold font-medium truncate",children:H})]})]})})}),(0,s.jsx)("nav",{className:"flex-1 space-y-2",children:G.map((e,a)=>{var r;let i=e.icon,o="/student-dashboard"===(r=e.href)?D===r:D.startsWith(r);return(0,s.jsxs)(T.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*a},className:"relative",onMouseEnter:()=>C(e.href),onMouseLeave:()=>C(null),children:[(0,s.jsxs)(l(),{href:e.href,className:"\n                        flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all group relative\n                        ".concat(o?"bg-gold-500/20 text-gold shadow-lg shadow-gold-500/10":"text-gold-300 hover:bg-navy-800/50 hover:text-gold-200","\n                      "),children:[(0,s.jsx)(i,{className:"w-5 h-5 flex-shrink-0"}),(0,s.jsx)(E.N,{children:t&&(0,s.jsx)(T.P.span,{className:"font-medium whitespace-nowrap flex-1",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.2},children:e.name})})]}),(0,s.jsx)(E.N,{children:!t&&P===e.href&&(0,s.jsx)(T.P.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},className:"absolute left-full ml-2 top-1/2 -translate-y-1/2 z-50",children:(0,s.jsx)("div",{className:"px-3 py-2 bg-navy-800 border border-gold-500/30 rounded-lg shadow-xl whitespace-nowrap",children:(0,s.jsx)("span",{className:"text-sm text-gold-200",children:e.name})})})})]},e.href)})}),L&&(0,s.jsx)("div",{className:"border-t border-gold-500/20 pt-4 mb-4",children:(0,s.jsxs)("div",{className:"".concat(q?"bg-purple-500/20 border-purple-500/30":"bg-blue-500/20 border-blue-500/30"," border rounded-lg p-3"),children:[(0,s.jsx)("p",{className:"text-xs text-center mb-2",children:(0,s.jsx)("span",{className:q?"text-purple-300":"text-blue-300",children:q?"Modo de Visualiza\xe7\xe3o Admin":"Acesso Administrativo"})}),(0,s.jsxs)("button",{onClick:async()=>{if(q)try{document.cookie="viewAsStudent=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",document.cookie="isAdminViewMode=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";let e=await fetch("/api/auth/view-as-student",{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include"});if(e.ok){let a=await e.json();await new Promise(e=>setTimeout(e,a.delay||100)),window.location.href=a.redirect||"/dashboard"}else setTimeout(()=>{window.location.href="/dashboard"},100)}catch(e){console.error("Error clearing view mode:",e),setTimeout(()=>{window.location.href="/dashboard"},100)}else window.location.href="/dashboard"},className:"w-full px-3 py-2 rounded-lg transition-all text-sm flex items-center justify-center gap-2 ".concat(q?"bg-purple-600/30 hover:bg-purple-600/50 text-purple-200":"bg-blue-600/30 hover:bg-blue-600/50 text-blue-200"),children:[(0,s.jsx)(j.A,{className:"w-4 h-4"}),q?"Sair do Modo Visualiza\xe7\xe3o":"Voltar ao Dashboard Admin"]})]})}),(0,s.jsx)("div",{className:"border-t border-gold-500/20 pt-4",children:(0,s.jsxs)("div",{className:"relative",onMouseEnter:()=>C("logout"),onMouseLeave:()=>C(null),children:[(0,s.jsxs)("button",{onClick:W,disabled:V,className:"\n                    flex items-center gap-3 px-3 py-2.5 w-full rounded-lg\n                    text-gold-300 hover:bg-red-500/20 hover:text-red-400 transition-all\n                    disabled:opacity-50 disabled:cursor-not-allowed\n                  ",children:[(0,s.jsx)(N.A,{className:"w-5 h-5 flex-shrink-0"}),(0,s.jsx)(E.N,{children:t&&(0,s.jsx)(T.P.span,{className:"font-medium whitespace-nowrap",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.2},children:V?"Saindo...":"Sair"})})]}),(0,s.jsx)(E.N,{children:!t&&"logout"===P&&(0,s.jsx)(T.P.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},className:"absolute left-full ml-2 top-1/2 -translate-y-1/2 z-50",children:(0,s.jsx)("div",{className:"px-3 py-2 bg-navy-800 border border-gold-500/30 rounded-lg shadow-xl whitespace-nowrap",children:(0,s.jsx)("span",{className:"text-sm text-gold-200",children:V?"Saindo...":"Sair"})})})})]})})]})}),(0,s.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,s.jsx)(d.A,{children:(0,s.jsx)(S.Ay,{children:(0,s.jsx)("div",{className:"p-8",children:a})})})})]})]})}},18186:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(19946).A)("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]])},28691:(e,a,t)=>{Promise.resolve().then(t.bind(t,9008))},35169:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(19946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},47924:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(19946).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},57434:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(19946).A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},69074:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(19946).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},71007:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(19946).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])}},e=>{e.O(0,[3254,9051,7244,6766,9350,1338,647,8441,5964,7358],()=>e(e.s=28691)),_N_E=e.O()}]);