(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1205],{16076:(e,o,s)=>{"use strict";s.r(o),s.d(o,{default:()=>i});var r=s(95155),a=s(12115),t=s(7815),n=s(46414);function i(){let{session:e,user:o}=(0,t.A)(),[s,i]=(0,a.useState)(null),[c,l]=(0,a.useState)([]),d=(0,n.U)();(0,a.useEffect)(()=>{u(),h()},[]);let u=async()=>{try{let e=await fetch("/api/auth/verify"),o=await e.json();i(o)}catch(e){i({error:e.message})}},h=()=>{l(document.cookie.split(";").map(e=>e.trim()).filter(e=>e.includes("sb-")))},p=async()=>{try{let{data:e,error:o}=await d.auth.refreshSession();if(o)throw o;alert("Refresh realizado! Recarregando..."),window.location.reload()}catch(e){alert("Erro no refresh: ".concat(e.message))}},m=async()=>{try{let{data:{session:e},error:o}=await d.auth.getSession();if((null==e?void 0:e.access_token)&&(null==e?void 0:e.refresh_token)){let o=await fetch("/api/auth/sync-session",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({access_token:e.access_token,refresh_token:e.refresh_token})}),s=await o.json();o.ok?(alert("Sess\xe3o sincronizada! Recarregando..."),window.location.reload()):alert("Erro: ".concat(s.error));return}let s=localStorage.getItem("sb-mdzgnktlsmkjecdbermo-auth-token");if(!s){let{data:e,error:o}=await d.auth.refreshSession();if(null==e?void 0:e.session){let o=await fetch("/api/auth/sync-session",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({access_token:e.session.access_token,refresh_token:e.session.refresh_token})}),s=await o.json();o.ok?(alert("Sess\xe3o recuperada e sincronizada! Recarregando..."),window.location.reload()):alert("Erro: ".concat(s.error))}else alert("Nenhuma sess\xe3o dispon\xedvel para sincronizar. Por favor, fa\xe7a login novamente.");return}let r=JSON.parse(s);if(!r.access_token||!r.refresh_token)return void alert("Tokens inv\xe1lidos no localStorage");let a=await fetch("/api/auth/sync-session",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({access_token:r.access_token,refresh_token:r.refresh_token})}),t=await a.json();a.ok?(alert("Sess\xe3o sincronizada do localStorage! Recarregando..."),window.location.reload()):alert("Erro: ".concat(t.error))}catch(e){alert("Erro ao sincronizar: ".concat(e.message))}},g=async()=>{try{document.cookie.split(";").forEach(e=>{let o=e.split("=")[0].trim();o.includes("sb-")&&(document.cookie="".concat(o,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"))}),Object.keys(localStorage).forEach(e=>{(e.includes("sb-")||e.includes("supabase"))&&localStorage.removeItem(e)}),alert("Cookies e storage limpos! Redirecionando para login..."),window.location.href="/"}catch(e){alert("Erro: ".concat(e.message))}};return(0,r.jsxs)("div",{style:{padding:"20px",fontFamily:"monospace"},children:[(0,r.jsx)("h1",{children:"\uD83D\uDC1B Debug Middleware"}),(0,r.jsxs)("div",{style:{margin:"20px 0",padding:"10px",border:"1px solid #ccc"},children:[(0,r.jsx)("h2",{children:"Estado do Cliente"}),(0,r.jsxs)("p",{children:["AuthProvider Session: ",e?"✅":"❌"]}),(0,r.jsxs)("p",{children:["AuthProvider User: ",o?"✅ ".concat(o.email):"❌"]})]}),(0,r.jsxs)("div",{style:{margin:"20px 0",padding:"10px",border:"1px solid #ccc"},children:[(0,r.jsx)("h2",{children:"Cookies do Browser"}),(0,r.jsxs)("p",{children:["Total de cookies Supabase: ",c.length]}),c.map((e,o)=>(0,r.jsxs)("div",{style:{fontSize:"12px",marginTop:"5px"},children:[e.substring(0,50),"..."]},o))]}),(0,r.jsxs)("div",{style:{margin:"20px 0",padding:"10px",border:"1px solid #ccc"},children:[(0,r.jsx)("h2",{children:"Verifica\xe7\xe3o do Servidor (/api/auth/verify)"}),(0,r.jsx)("pre",{style:{overflow:"auto",maxHeight:"300px",fontSize:"12px"},children:JSON.stringify(s,null,2)})]}),(0,r.jsxs)("div",{style:{margin:"20px 0"},children:[(0,r.jsx)("button",{onClick:u,style:{margin:"5px",padding:"10px"},children:"\uD83D\uDD04 Recarregar Verifica\xe7\xe3o"}),(0,r.jsx)("button",{onClick:p,style:{margin:"5px",padding:"10px"},children:"\uD83D\uDD04 For\xe7ar Refresh"}),(0,r.jsx)("button",{onClick:m,style:{margin:"5px",padding:"10px",background:"#4CAF50",color:"white"},children:"\uD83D\uDD04 Sincronizar Sess\xe3o Cliente→Servidor"}),(0,r.jsx)("button",{onClick:g,style:{margin:"5px",padding:"10px",background:"#ff6b6b",color:"white"},children:"\uD83D\uDDD1️ Limpar Tudo e Relogar"})]}),(0,r.jsxs)("div",{style:{margin:"20px 0",padding:"10px",border:"1px solid #0066ff"},children:[(0,r.jsx)("h2",{children:"Diagn\xf3stico"}),s&&(0,r.jsxs)(r.Fragment,{children:[s.hasUser&&!s.hasSession&&(0,r.jsx)("p",{style:{color:"orange"},children:"⚠️ Tem usu\xe1rio mas n\xe3o tem sess\xe3o - Middleware pode redirecionar"}),!s.hasUser&&!s.hasSession&&(0,r.jsx)("p",{style:{color:"red"},children:"❌ Sem usu\xe1rio e sem sess\xe3o - Necess\xe1rio fazer login"}),s.hasUser&&s.hasSession&&(0,r.jsx)("p",{style:{color:"green"},children:"✅ Usu\xe1rio e sess\xe3o OK - Deveria funcionar normalmente"})]})]})]})}},28818:(e,o,s)=>{Promise.resolve().then(s.bind(s,16076))},35695:(e,o,s)=>{"use strict";var r=s(18999);s.o(r,"useParams")&&s.d(o,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(o,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(o,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(o,{useSearchParams:function(){return r.useSearchParams}})},46414:(e,o,s)=>{"use strict";s.d(o,{U:()=>t});var r=s(83254);let a=null;function t(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(e&&(a=null),a&&!e)?a:a=(0,r.createBrowserClient)("https://mdzgnktlsmkjecdbermo.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1kemdua3Rsc21ramVjZGJlcm1vIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQwODE3OTcsImV4cCI6MjA2OTY1Nzc5N30.wVS4jMNTenVRSVtiuHFKo9OZ_RfUWiKV8ojN7ch67go",{cookieOptions:{name:"sb-auth-token",maxAge:10800,path:"/",sameSite:"lax",secure:!0},auth:{persistSession:!0,detectSessionInUrl:!0,autoRefreshToken:!0,storage:{getItem:e=>{let o=localStorage.getItem(e);if(o)return o;for(let o of document.cookie.split(";")){let[s,r]=o.trim().split("=");if(s===e)return decodeURIComponent(r)}return null},setItem:(e,o)=>{localStorage.setItem(e,o),document.cookie="".concat(e,"=").concat(encodeURIComponent(o)).concat("; Secure; SameSite=Lax; Path=/; Max-Age=".concat(10800))},removeItem:e=>{localStorage.removeItem(e),document.cookie="".concat(e,"=; Expires=Thu, 01 Jan 1970 00:00:00 UTC").concat("; Secure; SameSite=Lax; Path=/; Max-Age=0")}}},global:{headers:{"X-Client-Info":"swiftedu-web","X-Client-Version":"2.0"}}})}}},e=>{e.O(0,[3254,7815,8441,5964,7358],()=>e(e.s=28818)),_N_E=e.O()}]);