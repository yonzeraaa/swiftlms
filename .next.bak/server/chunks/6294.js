"use strict";exports.id=6294,exports.ids=[6294],exports.modules={86294:(a,b,c)=>{c.d(b,{xc:()=>g});var d=c(33103);function e(a,b=2){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}function f(a,b=!1){if("number"==typeof a)return b&&a<=1?e(100*a):e(a);if("string"==typeof a){let b=a.includes("%"),c=parseFloat(a.replace("%","").trim().replace(",","."));if(!isNaN(c))return e(c)}return a}class g{constructor(){this.workbook=d.Wp.book_new()}applyConditionalFormatting(a,b,c,d){if(d&&0!==d.length){for(let e of d)if(e.condition&&e.condition(b)){a[c].s||(a[c].s={}),e.font&&(a[c].s.font={bold:e.font.bold,color:e.font.color?{rgb:e.font.color.replace("#","")}:void 0,sz:e.font.size}),e.fill&&(a[c].s.fill={fgColor:{rgb:e.fill.color?.replace("#","")}}),e.numberFormat&&(a[c].s.numFmt=e.numberFormat);break}}}addDataSheet(a,b){let c=d.Wp.aoa_to_sheet([]),e=0;if(b.title&&(d.Wp.sheet_add_aoa(c,[[b.title]],{origin:`A${e+1}`}),c["!merges"]=c["!merges"]||[],c["!merges"].push({s:{r:e,c:0},e:{r:e,c:b.headers.length-1}}),e+=2),b.metadata){let a=[];b.metadata.date&&a.push(["Data do Relat\xf3rio:",b.metadata.date]),b.metadata.period&&a.push(["Per\xedodo:",b.metadata.period]),b.metadata.user&&a.push(["Gerado por:",b.metadata.user]),b.metadata.filters&&Object.entries(b.metadata.filters).forEach(([b,c])=>{a.push([`${b}:`,String(c)])}),a.length>0&&(d.Wp.sheet_add_aoa(c,a,{origin:`A${e+1}`}),e+=a.length+1)}d.Wp.sheet_add_aoa(c,[b.headers],{origin:`A${e+1}`}),e++;let g=b.data.map(a=>a.map((a,c)=>{let d=b.headers[c]?.toLowerCase()||"";return f(a,d.includes("taxa")||d.includes("porcentagem")||d.includes("%")||d.includes("percentual"))}));if(d.Wp.sheet_add_aoa(c,g,{origin:`A${e+1}`}),b.formatting)for(let a=0;a<g.length;a++)for(let f=0;f<g[a].length;f++){let h=d.Wp.encode_cell({r:e+a,c:f}),i=g[a][f];if(c[h]){if(this.applyConditionalFormatting(c,i,h,b.formatting.conditionalFormatting),b.formatting.columns&&b.formatting.columns[f]){let a=b.formatting.columns[f];(!a.condition||a.condition(i))&&this.applyConditionalFormatting(c,i,h,[a])}if(b.formatting.rows&&b.formatting.rows[a]){let d=b.formatting.rows[a];(!d.condition||d.condition(i))&&this.applyConditionalFormatting(c,i,h,[d])}let d=`R${a}C${f}`;if(b.formatting.cells&&b.formatting.cells[d]){let a=b.formatting.cells[d];(!a.condition||a.condition(i))&&this.applyConditionalFormatting(c,i,h,[a])}}}let h=e-1;for(let a=0;a<b.headers.length;a++){let b=d.Wp.encode_cell({r:h,c:a});c[b]&&(c[b].s={font:{bold:!0,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"003366"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"FFD700"}},bottom:{style:"thin",color:{rgb:"FFD700"}},left:{style:"thin",color:{rgb:"FFD700"}},right:{style:"thin",color:{rgb:"FFD700"}}}})}let i={s:{r:h,c:0},e:{r:e+b.data.length-1,c:b.headers.length-1}};c["!autofilter"]={ref:d.Wp.encode_range(i)};let j=[];for(let a=0;a<b.headers.length;a++){let c=b.headers[a].length;for(let d=0;d<b.data.length;d++)c=Math.max(c,String(b.data[d][a]||"").length);j.push(Math.min(c+2,50))}return c["!cols"]=j.map(a=>({wch:a})),d.Wp.book_append_sheet(this.workbook,c,a),this}addPivotTable(a,b,c){let e=this.createPivotData(b,c).map(a=>{let b={};return Object.keys(a).forEach(c=>{let d=c.toLowerCase(),e=d.includes("taxa")||d.includes("porcentagem")||d.includes("%")||d.includes("percentual")||d.includes("conclus\xe3o")||d.includes("aprova\xe7\xe3o");b[c]=f(a[c],e)}),b}),g=d.Wp.json_to_sheet(e),h=d.Wp.decode_range(g["!ref"]||"A1");for(let a=h.s.c;a<=h.e.c;++a){let b=d.Wp.encode_cell({r:0,c:a});g[b]&&(g[b].s={font:{bold:!0,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"003366"}},alignment:{horizontal:"center"},border:{top:{style:"thin",color:{rgb:"FFD700"}},bottom:{style:"thin",color:{rgb:"FFD700"}},left:{style:"thin",color:{rgb:"FFD700"}},right:{style:"thin",color:{rgb:"FFD700"}}}})}for(let a=h.s.r+1;a<=h.e.r;++a)for(let b=h.s.c;b<=h.e.c;++b){let c=d.Wp.encode_cell({r:a,c:b});g[c]&&(g[c].s=g[c].s||{},g[c].s.border={top:{style:"thin",color:{rgb:"D3D3D3"}},bottom:{style:"thin",color:{rgb:"D3D3D3"}},left:{style:"thin",color:{rgb:"D3D3D3"}},right:{style:"thin",color:{rgb:"D3D3D3"}}})}g["!autofilter"]={ref:d.Wp.encode_range(h)};let i=[];for(let a=h.s.c;a<=h.e.c;++a){let b=10;for(let c=h.s.r;c<=h.e.r;++c){let e=d.Wp.encode_cell({r:c,c:a});g[e]&&g[e].v&&(b=Math.max(b,String(g[e].v).length))}i.push({wch:Math.min(b+2,50)})}return g["!cols"]=i,d.Wp.book_append_sheet(this.workbook,g,a),this}createPivotData(a,b){let c=new Map;a.forEach(a=>{let d=b.rows.map(b=>a[b]).join("|"),e=b.columns.map(b=>a[b]).join("|");c.has(d)||c.set(d,new Map);let f=c.get(d);f.has(e)||f.set(e,[]),f.get(e).push(a)});let d=[],f=new Set;c.forEach(a=>{a.forEach((a,b)=>{f.add(b)})});let g=Array.from(f).sort(),h={};return b.rows.forEach(a=>{h[a]=a}),g.forEach(a=>{b.values.forEach(b=>{let c=a?`${a}_${b.field}`:b.field;h[c]=c})}),c.forEach((a,c)=>{let f={},h=c.split("|");b.rows.forEach((a,b)=>{f[a]=h[b]}),g.forEach(c=>{let d=a.get(c)||[];b.values.forEach(a=>{let b=c?`${c}_${a.field}`:a.field;switch(a.aggregation){case"sum":f[b]=e(d.reduce((b,c)=>b+(Number(c[a.field])||0),0));break;case"count":f[b]=d.length;break;case"average":let g=d.reduce((b,c)=>b+(Number(c[a.field])||0),0);f[b]=d.length>0?e(g/d.length):0;break;case"min":f[b]=d.length>0?e(Math.min(...d.map(b=>Number(b[a.field])||0))):0;break;case"max":f[b]=d.length>0?e(Math.max(...d.map(b=>Number(b[a.field])||0))):0}})}),d.push(f)}),d}addSummarySheet(a,b){let c=d.Wp.aoa_to_sheet([]),e=0;d.Wp.sheet_add_aoa(c,[[b.title]],{origin:`A${e+1}`}),c["!merges"]=c["!merges"]||[],c["!merges"].push({s:{r:e,c:0},e:{r:e,c:3}}),e+=2,b.sections.forEach(a=>{d.Wp.sheet_add_aoa(c,[[a.sectionTitle]],{origin:`A${e+1}`}),c["!merges"]=c["!merges"]||[],c["!merges"].push({s:{r:e,c:0},e:{r:e,c:1}}),e++,a.metrics.forEach(a=>{let b=a.label.toLowerCase(),g=b.includes("taxa")||b.includes("porcentagem")||b.includes("%")||b.includes("percentual"),h=f(a.value,g),i=h;g&&"number"==typeof h&&(i=`${h}%`),d.Wp.sheet_add_aoa(c,[[a.label,i]],{origin:`A${e+1}`}),e++}),e++});let g=d.Wp.decode_range(c["!ref"]||"A1");for(let a=g.s.r;a<=g.e.r;++a)for(let e=g.s.c;e<=g.e.c;++e){let f=d.Wp.encode_cell({r:a,c:e});c[f]&&0===e&&c[f].v&&"string"==typeof c[f].v&&(c[f].v===b.title||b.sections.some(a=>a.sectionTitle===c[f].v))&&(c[f].s={font:{bold:!0,size:0===e&&0===a?16:14},fill:{fgColor:{rgb:"E6EEF5"}},alignment:{horizontal:"center",vertical:"center"}})}return c["!cols"]=[{wch:30},{wch:20},{wch:20},{wch:20}],d.Wp.book_append_sheet(this.workbook,c,a),this}download(a){let b={type:"binary",bookSST:!0,bookType:"xlsx",sheet:"",compression:!1,Props:{Author:"SwiftEDU",CreatedDate:new Date}};d._h(this.workbook,a,b)}getBuffer(){return d.M9(this.workbook,{type:"array",bookType:"xlsx"})}getBase64(){return d.M9(this.workbook,{type:"base64",bookType:"xlsx"})}}}};